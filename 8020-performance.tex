 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 % $ID: hhbf-devlog.tex Tue, 07 Sep 2004 23:30:19 +0800  mhfan $ %
 %                                                              %
 % Description:                                                 %
 %                                                              %
 % Maintainer:  范美辉(Meihui Fan)  <mhfan@ustc.edu>            %
 %                                                              %
 % CopyRight (c)  2004  HHTech                                  %
 %   www.hhcn.com, www.hhcn.org                                 %
 %   All rights reserved.                                       %
 %                                                              %
 % This file is free software;                                  %
 %   you are free to modify and/or redistribute it  	        %
 %   under the terms of the GNU General Public Licence (GPL).   %
 %                                                              %
 % Last modified: Tue, 07 Jun 2005 17:41:09 +0800      by mhfan #
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\listfiles % (should list the files loaded and it's versions).

\documentclass[a4paper]{scrreprt}  % letter, article, scrartcl, report, book
			% 封面和扉页 % coverpage & titlepage
			% default is 10pt, letterpaper; letter

\usepackage{CJK,ifthen,inputenc,fontenc}%,ipalmacs
\usepackage{latexsym,amssymb,amsfonts,textcomp,pxfonts,txfonts,pifont,bbding}
\usepackage{marvosym,stmaryrd,ifsym,tipa,ulsy,dingbat,ipa,wasysym,manfnt} %
\usepackage{longtable,multirow,hhline,dcolumn,tabularx,array}
\usepackage{makeidx,verbatim,fancybox,colortbl}

\usepackage{fancyhdr}	% fancy header & footer, box
\newcommand{\makeheadrule}{         % 定义页眉横线
  \rule[.7\baselineskip]{\headwidth}{1.2pt}\vskip-0.97\baselineskip
  \rule[.6\baselineskip]{\headwidth}{0.4pt}}
%  \makebox[-3pt][l]{\rule[.7\baselineskip]{\headwidth}{0.4pt}}
%  \rule[0.85\baselineskip]{\headwidth}{1.5pt}\vskip-.8\baselineskip}
  \makeatletter
  \renewcommand{\headrule}{
  	{\if@fancyplain\let\headrulewidth\plainheadrulewidth\fi}\makeheadrule}
  \makeatother

\usepackage{graphicx,subfigure,wrapfig}	% for graph
\graphicspath {{./}{figs/}} % set graphics path
\DeclareGraphicsExtensions{.eps,.ps,.eps.gz,.ps.gz,.jpg,.jpeg,.pdf,.gif,.png}
%\DeclareGraphicsRule{.jpg}{eps}{}{`convert #1 eps:-}
\DeclareGraphicsRule{*}{mps}{*}{}

\usepackage[a4paper,pdftex]{geometry}
%\geometry{top=1.7cm,bottom=2cm,left=2.5cm,right=2.1cm}
%\geometry{body={15.6cm, 20cm}, centering, dvipdfm}

\usepackage[CJKbookmarks,dvipdf,bookmarks=true]{hyperref}
% setup hyperref for PDF nevigation:
  \hypersetup{colorlinks, linkcolor=blue, citecolor=blue, urlcolor=red,%
	plainpages=true, bookmarksopen=false,%
	pdfhighlight=/P, %/I(inverse) /N(no effect) /O(outline) /P(inset)
	pdfauthor={Meihui Fan <mhfan@ustc.edu>},%
	pdftitle={A LaTeX example collection},%
	pdfsubject={LaTeX, TeX},%
	pdfkeywords={LaTeX, TeX, Typesetting},%
	pdfstartview=FitH, %FitBH, FitB
	pdfview=FitH,
	pdfpagemode=UseOutlines, %None, FullScreen, UseThumbs
}

\usepackage{listings} %[mathscope]
  \lstloadlanguages{C++, bash, tcl, VHDL, Haskell, Lisp, TeX, Oz, Perl, make}
  %\lstinline!char foo='c';!	% ! can be #, %, $, etc.
  \lstset{language=C, tabsize=8, keepspaces=true,
	columns=fixed, %flexiblecolumns=true,
	numbers=left, stepnumber=1, numberstyle=\tiny,
	basicstyle=\small\ttfamily, showspaces=false,
	%identifierstyle=\color{blue},
	stringstyle=\color{magenta},
	keywordstyle=\color{green}\textbf,
	commentstyle=\color{cyan}\bfseries\itshape,
	%classoffset=2,
	%morekeywords={typedef,struct,enum,int,long,unsigned},
	%keywordstyle=[2]\color{green}\bfseries,
	%breaklines=true, breakautoindent=true, breakindent=4em,
	escapeinside={/*@}{@*/}
}

%\newcommand{}		% newcommand definition:
%\renewcommand{}	% redefine command:
%\renewcommand{\headrule}{}
\renewcommand\labelitemi{\small\EightFlowerPetal}
\renewcommand\labelitemii{\small\SixFlowerAltPetal}
\renewcommand\labelitemiii{\small\FiveStarConvex}
\setlength{\parskip}{4pt plus1pt minus1pt}
\newcommand{\ucl}{$\muup$Clinux~}

% Don't report over-full v/h-boxes if over-edge is small.
\vfuzz 2pt \hfuzz 2pt
\setlength{\parindent}{0em} %\parskip 3mm
% indent 2 Chinese characters befor each paragraph.
\setlength{\parindent}{2em} %\parskip 3mm
\makeatletter		    % indent the first paragraph. [indentfirst]
    \let\@afterindentfalse\@afterindenttrue
    \@afterindenttrue
\makeatother

\begin{document} \begin{CJK*}{GBK}{song}

\pagestyle{fancy}
%\lhead{} \chead{} \rhead{}
\lfoot{HH Tech China} %\rfoot{\today} \cfoot{}	% 第\thepage页（共\lastpage页）
\CJKcaption{GB}

\title{\Huge Performance of \\ New 8020 Backend Board
%\footnote{Keeping like free format document prefer in plain text.}
\vspace{1cm}} 
% 标题
\author{Version 0.0.1 \footnote{revised version} \vspace{1cm} \\
Meihui Fan \\ {\CJKfamily{kai} 范~美~辉} \\	% 作者
$<$\href{mailto:mhfan@ustc.edu}{mhfan@ustc.edu}$>$ \\
%$<$\href{mailto:hhbf-support@hhcn.com}{hhbf-support@hhcn.com}$>$ \\
% {{{
%\texttt{<}\href{mailto:mhfan@ustc.edu}{mhfan@ustc.edu}\texttt{>} \\
%\texttt{\#}, \textless, \textgreater, \textlangle, \textrangle
					% E-mail: mhfan@163.com
%中国科学技术大学，生命科学学院 \\	% organization
%安徽省合肥市四号信箱4号楼404室，230027} % address
%\textit{Laboratory of Structural Biology, School of Life Science, USTC} \\
%\textit{Room 4-404, P.O.Box 4, Hefei, Anhui, 230027 P. R. China} \\
% }}}
\vspace{2cm} \\ Copyleft \textcopyleft{} \number\year{}~ HHTech. Co., Ltd.
\footnote{\href{http://www.hhcn.com}{http://www.hhcn.com}} \\
All rights reserved. \\ \\ {\CJKfamily{li} 华恒科技　版权所有} \vspace{1cm}
}
%\date{}		% 日期
\maketitle \titlepage	% generate the title, 标题页

\iffalse
\thanks{\bf\large ~ ~ ~Thanks}		% 致谢

\begin{abstract}	% 摘要
  \vspace{1cm} {\it Keywords: .}	% 关键字
\end{abstract}
\fi

% {{{
\newpage
%\setcounter{tocdepth}{3}
\tableofcontents	% 目录页
%\listoffigures
%\listoftables

\newpage
%\thispagestyle{fancy}
% }}}

\renewcommand\thefootnote{\tiny\textcircled{\arabic{footnote}}}
%\renewcommand\thefootnote{\tiny\makebox[0pt][l]{\circle}{\arabic{footnote}}}
%\renewcommand\thefootnote{\scriptsize\ding{191 + \arabic{footnote}}}

\chapter{8020 后端板的千兆网口}

\section{任务描述}
调通新 8020 后端板的千兆网口(RTL8169)――缺少 EEPROM，并评测网络性能。

\section{调试记录}
\newcommand{\debug}[3]{
    \begin{description}
      \item [\color{green}现象描述]：\\ #1
      \item [\color{green}原因分析]：\\ #2
      \item [\color{green}解决方法]：\\ #3
%      \item [注意事项]：\\ #4
    \end{description}
}

\begin{enumerate}
  \item \debug{
    PCI 总线检测到的 RTL8169 的设备号是\texttt{0x8129}，不同于正常的 
    \texttt{0x8169}。
    }{未知，可能设备号也由 EEPROM 中加载。}{
    将 RTL8169 驱动的 PCI 设备匹配表的设备 ID 改为，\texttt{PCI\_ANY\_ID}――
    即只匹配 vendor ID。
    }%{d}
  \item \debug{
    \texttt{pci\_find\_capability} 函数返回失败，导致内核恐慌。
    }{
    EEPROM 中存有电源管理相关的信息，这个函数取不到 RTL8169 的电源状态（可能是
    访问非法地址），所以出错。但是这不是必须的，事实上 RealTek 发布的驱动中就
    没有这个功能。
    }{ comment out.  }
  \item \debug{
    驱动正常加载，发包正常，但没有收包中断；LED 显示，物理层／链路层工作正常。
    }{
    可能是默认的参数不能正常工作。
    \begin{quote}
The EEPROM interface provides the ability for the RTL8169S to read from and
write data to an external serial EEPROM device. Values in the external EEPROM
allow default fields in PCI configuration space and I/O space to be overridden
following a reboot or software EEPROM auto load command. The RTL8169S will auto
load values from the EEPROM. {\color{blue} If the EEPROM is not present,
the RTL8169S initialization uses default values for the appropriate
Configuration and Operational Registers.} Software can read and write to the
EEPROM using ``bit-bang'' accesses via the 9346CR Register. The interface
consists of EESK, EECS, EEDO, and EEDI.
    \end{quote}
    }{
    焊上 EEPROM 后，一切正常。另外，向 RealTek 公司申请 RTL8169 的软件编程资料
    ；希望能够手动设置RTL8169 芯片的工作状态。
    }
\end{enumerate}

\section{性能测试}

\subsection{测试环境}
\subsubsection{硬件}

\begin{center}
\begin{tabular}{l|c|c} \ttfamily
  　 & [TARGET] & [HOST] \\ \hline
  CPU & PowerPC 7410, altivec supported & AMD Sempron(tm) 2500+ \\
  MEM & 128MB SDRAM & 256MB DDRAM \\
  NET & RTL8169 & RTL8169 \\
\end{tabular}
\end{center}

用对接双绞线连接新8020 后端板上的千兆网口与　PC　机上的千兆网口，
弃用板上的百兆网口。

\subsubsection{软件 ------ LMbench}
LMbench 的移植可以在命令行上完成，不需要调整任何代码：
\begin{quote} \ttfamily
  \$ cd /path/to/lmbench-root-directory/src \\
  \$ make OS=powerpc-7410-linux-gnu $\backslash$ \\
   　　　~CC=powerpc-7410-linux-gnu-gcc $\backslash$ \\
   　　　~LDFLAGS=-static
\end{quote}
如果没有编译除错，会在 \texttt{<lmbench-root-directory>/bin} 目录下对应 
\texttt{OS} 目录下生成一套系统性能测试工具集：
\begin{quote} \ttfamily
  \$ cd /path/to/lmbench-root-directory/bin \\
  \$ ls -R
\end{quote}
\begin{verbatim}
.:
powerpc-7410-linux-gnu/

./powerpc-7410-linux-gnu:
bw_file_rd*  flushdisk*    lat_mmap*       lat_udp*           lmdd*
bw_mem*      hello*        lat_pagefault*  lat_unix*          lmhttp*
bw_mmap_rd*  lat_connect*  lat_pipe*       lat_unix_connect*  loop_o*
bw_pipe*     lat_ctx*      lat_proc*       lib_stats.o        memsize*
bw_tcp*      lat_fcntl*    lat_rpc*        lib_tcp.o          mhz*
bw_unix*     lat_fifo*     lat_select*     lib_timing.o       msleep*
clock*       lat_fs*       lat_sig*        lib_udp.o          timing_o*
disk*        lat_http*     lat_syscall*    lib_unix.o
enough*      lat_mem_rd*   lat_tcp*        lmbench.a
\end{verbatim}

这些程序可以运行于新 8020 目标板用于性能测试。

\subsection{测试报告}
\subsubsection{测试命令}
\begin{center}
\begin{tabular}{l||l} \ttfamily
  {　　　　　[TARGET]} & {　　　　　　[HOST]} \\ \hline
  \# /path/to/bw\_tcp -s & \$ /path/to/bw\_tcp target-hostname \\
  \# /path/to/bw\_tcp pc-hostname & \$ /path/to/bw\_tcp -s \\
  \# /path/to/lat\_tcp -s & \$ /path/to/lat\_tcp target-hostname \\
  \# /path/to/lat\_tcp pc-hostname & \$ /path/to/lat\_tcp -s \\
  \# /path/to/lat\_udp -s & \$ /path/to/lat\_udp target-hostname \\
  \# /path/to/lat\_udp pc-hostname & \$ /path/to/lat\_udp -s \\
  \# /path/to/bw\_unix & \$ /path/to/bw\_unix \\
  \# /path/to/lat\_unix & \$ /path/to/lat\_unix \\
  \# /path/to/lat\_connect -s & \$ /path/to/lat\_connect target-hostname \\
  \# /path/to/lat\_connect pc-hostname & \$ /path/to/lat\_connect -s \\
  \\
\end{tabular}
\end{center}

\subsubsection{Flood ping}
\begin{quote}
\begin{verbatim}
$ ping -f 192.168.0.3
PING 192.168.0.3 (192.168.0.3) 56(84) bytes of data.

--- 192.168.0.3 ping statistics ---
96438482 packets transmitted, 96438482 received,
	0% packet loss, time 7186346ms
rtt min/avg/max/mdev = 0.027/0.031/2948.612/0.560 ms,
	pipe 5, ipg/ewma 0.074/0.048 ms
\end{verbatim}
\end{quote}

\subsubsection{带宽和延时}
\begin{center}\ttfamily
  \begin{tabular}{|l|>{\columncolor[gray]{0.8}}c|c
		    |>{\columncolor[gray]{0.8}}c|c|} \hline
    　& TCP & UDP & UNIX SOCKET & CONN \footnotemark \\ \hline
    H~\Rightarrow~T & 58.46MB/s \vline{} 58.85us & - \vline{} ~9.27us &
    740.94MB/s \vline{} ~7.26us & - \vline{} 122.63us \\ \hline
    T~\Rightarrow~H & 57.08MB/s \vline{} 59.08us & - \vline{} 22.81us & 
    172.28MB/s \vline{} 14.70us & - \vline{} 158.22us \\ \hline
  \end{tabular}
\end{center}

\footnotetext[1]{TCP/IP connection}

\subsection{结果分析}
测试结果表明板子的网络性能表现良好，至少不应该会成为磁盘性能的瓶颈；但是网络延
时劣于 PC 的表现。另外，LMbench 测试套件中没有 UDP 带宽的测试工具，可能需要找
其它的测试套件。

\section{总结思考}
\ldots

\chapter{8020 后端板的 RAID 模块}

\section{任务描述}
评测新 8020 后端板的 RAID-5 性能。

\section{调试记录}

\begin{enumerate}
  \item \debug{
    测试过程中在{\em \color{blue} 写}磁盘的时候频繁报错：
    \begin{quote} \ttfamily
      drivers/scsi/gd31244/drv/gd31244\_lld.c\#3128:gd31244\_isr:\\
      **** ERROR: Ignoring command 0 that is not active (0)
    \end{quote}
    }{
    可能与磁盘供电有关，电压不稳或不足。
    }{
    \ldots
    }

  \item \debug{
多线程上传同时 NFS 回放时内核打印内存分配错误：

{\ttfamily\color{blue} swapper: page allocation failure. order:0, mode:0x20 }
\iffalse
eth0: no Rx buffer allocated

Call trace:
\begin{verbatim}
 [c0007080] dump_stack+0x18/0x28
 [c0036a90] __alloc_pages+0x220/0x388
 [c0036c24] __get_free_pages+0x2c/0x60
 [c003a890] kmem_getpages+0x2c/0x138
 [c003b6f4] cache_grow+0xa0/0x170
 [c003b988] cache_alloc_refill+0x1c4/0x260
 [c003bd94] __kmalloc+0xa8/0xb4
 [c01d39ec] alloc_skb+0x4c/0xe0
 [c011a6f4] rtl8169_alloc_rx_skb+0x28/0x134
 [c011a8e8] rtl8169_rx_fill+0x80/0x8c
 [c011b66c] rtl8169_rx_interrupt+0x1e0/0x370
 [c011b924] rtl8169_interrupt+0x128/0x15c
 [c0030a20] handle_IRQ_event+0x54/0xb0
 [c0030b98] __do_IRQ+0x11c/0x160
 [c00056d0] do_IRQ+0x50/0x98
或者：
 [c0007080] dump_stack+0x18/0x28
 [c0036a90] __alloc_pages+0x220/0x388
 [c0036c24] __get_free_pages+0x2c/0x60
 [c003a890] kmem_getpages+0x2c/0x138
 [c003b6f4] cache_grow+0xa0/0x170
 [c003b988] cache_alloc_refill+0x1c4/0x260
 [c003bd94] __kmalloc+0xa8/0xb4
 [c01d39ec] alloc_skb+0x4c/0xe0
 [c011da44] allocate_rx_buffer+0x38/0xc4
 [c011c598] dmfe_interrupt+0x134/0x1b8
 [c0030a20] handle_IRQ_event+0x54/0xb0
 [c0030b98] __do_IRQ+0x11c/0x160
 [c00056d0] do_IRQ+0x50/0x98
 [c0004800] ret_from_except+0x0/0x14
 [c0003d2c] ppc6xx_idle+0xe4/0xf0
\end{verbatim}
\fi
    }{
    \ldots
    }{
    \ldots
    }
\end{enumerate}

\section{性能测试}

\subsection{测试环境}

\subsubsection{硬件}
\begin{center}
\begin{tabular}{r l} \ttfamily
   CPU & PowerPc 7410, altivec supported \\
  DISK & 4 $\times$ ST3160023AS(160GB, 7200.7, 8MB, SATA) \\
   MEM & 128MB SDRAM \\
   NET & RTL8169 \\
  \\
\end{tabular}
\end{center}

\subsubsection{软件 ------ RAID HOWTO}
\begin{enumerate}
  \item 创建磁盘分区\footnote{单主分区每磁盘，分区格式~{\ttfamily 0xfd}(
    Linux RAID auto)。}：
    \begin{quote} \ttfamily \# fdisk /dev/sda \end{quote}
  \item Setup the /etc/raidtab file like this:
    \begin{quote}
      \begin{verbatim}
raiddev /dev/md0
        raid-level              5
        nr-raid-disks           4
        nr-spare-disks          0
        persistent-superblock   1
        parity-algorithm        left-symmetric
        chunk-size              32
        device                  /dev/sda1
        raid-disk               0
        device                  /dev/sdb1
        raid-disk               1
        device                  /dev/sdc1
        raid-disk               2
        device                  /dev/sdd1
        raid-disk               3
    \end{verbatim}
  \end{quote}
  \item 创建 RAID 卷：
    \begin{quote} \ttfamily \# mkraid /dev/md0 \end{quote}
  \item 在 RAID 卷上创建文件系统：
    \begin{quote} \ttfamily \# mke2fs -b 4096 -R stride=8 /dev/md0 \end{quote}
  \item 加载 RAID 卷：
    \begin{quote} \ttfamily \# mount /dev/md0 /hd \end{quote}
\end{enumerate}

\subsection{测试报告}
\subsubsection{测试命令}
\begin{center} \ttfamily
  \begin{quote}
\# /path/to/bw\_mem 8m \\
\# /path/to/lat\_fs /path/to/directory \\
\# /path/to/disk /path/to/raw-disk \# e.g.: /dev/md0 \\
\# /path/to/bw\_file\_rd 8m open2close /path/to/bench-stuff \\
\# /path/to/bw\_mmap\_rd 8m io\_only /path/to/bench-stuff \\
\$ time lftp -e ``get /path/to/bench-stuff; quit'' ftp-url-path \\
\$ time lftp -e ``put /path/to/bench-stuff; quit'' ftp-url-path \\
\$ time cp /path/to/nfs-mount-point /path/to/bench-stuff \\
\$ time cp /path/to/bench-stuff /path/to/nfs-mount-point \\
\# /path/to/time cp /path/to/nfs-mount-point /path/to/bench-stuff \\
\# /path/to/time cp /path/to/bench-stuff /path/to/nfs-mount-point \\
\$ time cp /path/to/smb-mount-point /path/to/bench-stuff \\
\$ time cp /path/to/bench-stuff /path/to/smb-mount-point \\
\# /path/to/lmdd if=internal of=/path/to/bench-stuff count=??? fsync=1 \\
\# /path/to/lmdd if=/path/to/bench-stuff of=internal \\
%pipe bandwidth: 197.36MB/sec
  \end{quote}
\end{center}

\subsubsection{RAID-5 测试结果}
memory copy speeds: (MB/s)
\begin{center} \ttfamily \scriptsize
\begin{tabular}{|c|c|c|c|c|c|c|c|c|} \hline
rd & wr & rdwr & cp & fwr & frd & fcp & bzero & bcopy \\ \hline
395.84 & 204.32 & 201.10 & 126.10 & 257.33 &
	 236.01 & 112.94 & 276.30 & 112.70 \\ \hline
\end{tabular}
\end{center}

file system create/delete performance:
\begin{center} \ttfamily
\begin{tabular}{|r|r|r|r|} \hline
size & files & create  & delete   \\ \hline
 0k  & 1000  & 27134/s & 119346/s \\ \hline
 1k  & 1000  &  9251/s &  48414/s \\ \hline
 4k  & 1000  &  9300/s &  48555/s \\ \hline
10k  & 1000  &  6633/s &  36880/s \\ \hline
\end{tabular}
\end{center}

disk performace\footnote{测试文件大小：1073565696 B。}: (MB/s)
\begin{center} \ttfamily
\begin{tabular}{||l|r|r||} \hline \hline
  　 & {\color{blue}zone}　　　　　 & {\color{blue}seek}　　　　　 \\ \hline
raw disk perf & 1.21/35.759/146.78 (MB/s) & 1.57/14.2448/78.25 (ms) \\ \hline 
\hline
　 & {\color{blue}read}　　　　　 & {\color{blue}mmap}　　　　　 \\ \hline
file bandwidth & 145.49 & 235.99 \\ \hline \hline
　 & {\color{blue}read}　　　　　 & {\color{blue}write}　　　　　 \\ \hline
lmdd bandwidth & 39.18 & 35.84 \\ \hline \rowcolor[gray]{0.8}
ftpd bandwidth & 22.78 & 15.57 \\ \hline
nfsd bandwidth & 21.99 & 14.35 \\ \hline \rowcolor[gray]{0.8}
nfs~ bandwidth & 15.89 & 14.23 \\ \hline
smbd bandwidth & 11.42 &  2.42 \\ \hline
\hline
\end{tabular}
\end{center}

\subsubsection{单块硬盘测试结果}
Single ST380013AS, 80GB, 7200.7, 8MB, SATA.

file system create/delete performance:
\begin{center} \ttfamily
\begin{tabular}{|r|r|r|r|} \hline
size & files & create & delete   \\ \hline
 0k  & 1000  & 9339/s & 43170/s \\ \hline
 1k  & 1000  & 5128/s & 19192/s \\ \hline
 4k  & 1000  & 5139/s & 19369/s \\ \hline
10k  & 1000  & 3724/s & 16474/s \\ \hline
\end{tabular}
\end{center}

disk performace\footnote{测试文件大小：1073565696 B。}: (MB/s)
\begin{center} \ttfamily
\begin{tabular}{||l|r|r||} \hline \hline
\hfill & {\color{blue}zone}　　　　　 & {\color{blue}seek}　　　　　 \\ \hline
raw disk perf & 30.05/39.9131/47.53 (MB/s) & 4.50/15.203/29.52 (ms) \\ \hline 
\hline
\hfill & {\color{blue}read}　　　　　 & {\color{blue}mmap}　　　　　 \\ \hline
file bandwidth & 144.89 & 236.08 \\ \hline \hline
\hfill & {\color{blue}read}　　　　　 & {\color{blue}write}　　　　　 \\ \hline
lmdd bandwidth & 56.12 & 47.36 \\ \hline \rowcolor[gray]{0.8}
ftpd bandwidth & 25.54 & 16.78 \\ \hline
nfsd bandwidth & 25.34 & 14.79 \\ \hline \rowcolor[gray]{0.8}
nfs~ bandwidth & 15.38 & 14.78 \\ \hline
smbd bandwidth & 10.05 &  2.34 \\ \hline
\hline
\end{tabular}
\end{center}

\subsubsection{上传／下载和 NFS 回放}
FTP： 8 线程同时上传／下载，没线程带宽：1.2 MB/s ~ 1.4 MB/s；
回放基本流畅，偶尔丢帧，这应该是极限情况。

SAMBA：6 进程上传／下载时回放正常；再有进程上传／下载过程中没有问题，
但当文件上传／下载完成时会有丢帧。

\subsection{结果分析}
测试结果说明在新 8020 后端板上，RAID-5 似乎没有起到磁盘访问加速的作用，尤其与
单块硬盘的性能相比，在某些测试上 RAID-5 还不如单块磁盘的结果。我确定我的操作没
有问题，所以可能的原因如下：
\begin{itemize}
  \item 板子的磁盘性能在物理参数上优于 PC 机，所以对于联网测试性能瓶颈在于
    PC 机；所以如果要测试出板子的真实性能必须采用在物理参数{\color{blue} \em 至
    少}是相同的硬件平台。
  \item LMbench 测试套件可能测试不出 RAID-5 的性能（这似乎不应该，只是怀疑），
    可能需要找一些其它的测试软件，最好是寻找和采用专门的磁盘性能测试软件
    （RAID 磁盘性能测试软件？）。
\end{itemize}

\section{总结思考}
\ldots

\newpage
\thebibliography{99}
\makeatletter \renewcommand\@biblabel[1]{#1} \makeatother
%\cite[append-info]{keyword}
%\begin{thebibliography}{label-style}
%\bibitem[label]{keyword}text-item
%\bibitem[\HandRight]{mp3ext}
%    ``{\it MP3 Extensions}'', Alex Beregszaszi, November 28, 2003.
%   (\href{http://home.pcisys.net/~melanson/codecs/mp3extensions.txt}
%	 {http://home.pcisys.net/~melanson/codecs/mp3extensions.txt}) \\
%    {\sl provide the informal explaination of MP3 Xing VBR header,
%	 LAME header, etc.}
\bibitem[\HandRight]{lmbench}
  ``LMbench document and manual'', \href{http://www.bitmover.com/lmbench/}
  {http://www.bitmover.com/lmbench/}.

\bibitem[\HandRight]{rtl8169}
  ``RTL8169S-32/RTL8169S-64 DATASHEET'', \href{http://www.realtek.com.tw}
  {http://www.realtek.com.tw}.

\bibitem[\HandRight]{raid}
  ``RAID 技术简介'', 
  \href{http://www.forecast.com.cn/network/jishuzhichi-xt-4.htm}
  {http://www.forecast.com.cn/network/jishuzhichi-xt-4.htm}

\bibitem[\HandRight]{raid}
  ``Software-RAID-HOWTO'', \href{http://www.tldp.org/HOWTO/Software-RAID-HOWTO.html}{http://www.tldp.org/HOWTO/Software-RAID-HOWTO.html}

\bibitem[\HandRight]{raid}
  ``RAID 磁盘阵列技术全面介绍'',
  \href{http://www.ccw.com.cn/server/jssc/htm2005/20050520\_14RU3.htm}
  {http://www.ccw.com.cn/server/jssc/htm2005/20050520\_14RU3.htm}

\bibitem[\HandRight]{raid}
  ``Redundant array of independent disks'', 
  \href{http://en.wikipedia.org/wiki/Redundant\_array\_of\_independent\_disks}
  {http://en.wikipedia.org/wiki/Redundant\_array\_of\_independent\_disks}

%\end{thebibliography}
\nocite{*}
%\bibliography{biblio}	% 参考资料
%\bibliographystyle{plain}	% unsrt, alpha, abbrev

%\newpage
%\begin{appendix}	% 附录
%    \renewcommand{\thesection}{附录\Alph{section}}
%    %\addcontentsline{toc}{section}{\thesection~~}
%    %\appendix \section{BF533 vs. BF561}
%
%\end{appendix}

%\printidx
\end{CJK*} \end{document}

 %%%%%%%%%%%%%%%%%%%% End Of File: hhbf-devlog.tex %%%%%%%%%%%%%%%%%%%%
